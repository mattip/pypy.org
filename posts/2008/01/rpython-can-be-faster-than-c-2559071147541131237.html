<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>RPython can be faster than C | PyPy</title>
<link href="../../../assets/css/rst_base.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_rst.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/styles.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://www.pypy.org/posts/2008/01/rpython-can-be-faster-than-c-2559071147541131237.html">
<link rel="icon" href="../../../favicon2.ico" sizes="16x16">
<link rel="icon" href="../../../favicon32x32.ico" sizes="32x32">
<!--[if lt IE 9]><script src="../../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
<meta name="author" content="The PyPy Team">
<link rel="prev" href="pypynet-goes-windows-forms-7031406830502864570.html" title="PyPy.NET goes Windows Forms" type="text/html">
<link rel="next" href="pypy-keyboard-heatmap-4950995633665492453.html" title="PyPy Keyboard Heatmap" type="text/html">
<meta property="og:site_name" content="PyPy">
<meta property="og:title" content="RPython can be faster than C">
<meta property="og:url" content="https://www.pypy.org/posts/2008/01/rpython-can-be-faster-than-c-2559071147541131237.html">
<meta property="og:description" content="(yes, C as in language, not c as in speed of light). I looked recently at the great computer language shootout, for some benchmarks and to make some speed comparisons. I use this benchmark, modified i">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2008-01-21T12:38:00Z">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
             <header id="header"><!-- Adapted from https://www.taniarascia.com/responsive-dropdown-navigation-bar --><section class="navigation"><div class="nav-container">
            <div class="brand">
                <a href="../../../index.html">
                    <image id="toplogo" src="../../../images/pypy-logo.svg" width="75px;" alt="PyPy/"></image></a>
            </div>
            <nav><ul class="nav-list">
<li> 
                <a href="#!">Features</a>
                <ul class="nav-dropdown">
<li> <a href="../../../features.html">What is PyPy?</a> </li>  
                    <li> <a href="../../../compat.html">Compatibility</a> </li>  
                    <li> <a href="../../../performance.html">Performance</a> </li>  
                </ul>
</li>
          <li> <a href="../../../download.html">Download</a> </li>  
          <li> <a href="http://doc.pypy.org">Dev Docs</a> </li>  
            <li> 
                <a href="#!">Blog</a>
                <ul class="nav-dropdown">
<li> <a href="../../../blog">Index</a> </li>  
                    <li> <a href="../../../categories">Tags</a> </li>  
                    <li> <a href="../../../archive.html">Archive by year</a> </li>  
                    <li> <a href="../../../rss.xml">RSS feed</a> </li>  
                    <li> <a href="https://morepypy.blogspot.com/">Old site</a> </li>  
                </ul>
</li>
            <li> 
                <a href="#!">About</a>
                <ul class="nav-dropdown">
<li> <a href="https://twitter.com/pypyproject">Twitter</a> </li>  
                    <li> <a href="https://quodlibet.duckdns.org/irc/pypy/latest.log.html#irc-end">IRC</a> </li>  
                    <li> <a href="../../../people.html">People</a> </li>  
                    <li> <a href="../../../howtohelp.html">How To Help?</a> </li>  
                    <li> <a href="../../../contact.html">Contact</a> </li>  
                </ul>
</li>

                </ul></nav><div class="nav-mobile">
                <a id="nav-toggle" href="#!"> <span></span></a>
            </div>
        </div>
    </section></header><main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><div class="post">
          <header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">RPython can be faster than C</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    The PyPy Team
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2008-01-21T12:38:00Z" itemprop="datePublished" title="2008-01-21 12:38">2008-01-21 12:38</time></a>
            </p>
            <p class="commentline">  14 comments
</p>
                <p class="commentline">                <a href="rpython-can-be-faster-than-c-2559071147541131237.html#utterances-thread">Comments</a>


            
        </p>
</div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
      <p>(yes, C as in language, not c as in speed of light). I looked recently at the great computer language shootout, for some benchmarks and to make some speed comparisons. I use <a href="https://shootout.alioth.debian.org/gp4/benchmark.php?test=binarytrees&amp;lang=all">this</a> benchmark, modified it to be rpythonic-enough and compared speeds. The code is <a href="https://codespeak.net/svn/user/fijal/targetshootout.py">here</a> (the only change from the Python version was to create a class instead of tuple, so actually this version is <i>more</i> OO). Also the benchmark is very likely flawed because it favours better GCs :).<br>
So, here we go:

</p>
<table>
<tr>
<td>Language:</td>
<td>Time of run (for N=14):</td>
</tr>
<tr>
<td>Python version running on Python 2.5.1, distribution</td>
<td>25.5s</td>
</tr>
<tr>
<td>Python version running on PyPy with generational GC</td>
<td>45.5</td>
</tr>
<tr>
<td>Python with psyco</td>
<td>20s</td>
</tr>
<tr>
<td>RPython translated to C using PyPy's generational GC</td>
<td>0.42s</td>
</tr>
<tr>
<td>compiling the Haskell version with GHC 6.6.1</td>
<td>1.6s</td>
</tr>
<tr>
<td>compiling the C version with gcc 4.1.2 -O3 -fomit-frame-pointer</td>
<td>0.6s</td>
</tr>
</table>
<br><br>

Also worth noticing is that when using psyco with the original version (with tuples) it is very fast (2s).<br><br>

So, PyPy's Python interpreter is 80% slower than CPython on this (not too horrible), but RPython is 40% faster than gcc here. Cool. The result is mostly due to our GC, which also proves that manual memory-management can be <i>slower</i> than garbage collection in some situations. Please note that this result does not mean that RPython is meant for <b>you</b>. It requires a completely different mindset than the one used to program in Python. <i>Don't say you weren't warned! :-)</i>
      </div>
      <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="pypynet-goes-windows-forms-7031406830502864570.html" rel="prev" title="PyPy.NET goes Windows Forms">Previous post</a>
            </li>
            <li class="next">
                <a href="pypy-keyboard-heatmap-4950995633665492453.html" rel="next" title="PyPy Keyboard Heatmap">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
                <div class="comment-level comment-level-1">
      <div class="comment comment-2233468157482178641">
        <div class="comment-header">
          <a name="comment-2233468157482178641"></a>
            <span class="author">Jonathan Ellis</span> wrote on <span class="date">2008-01-21 16:02</span>:
        </div>
        <div class="comment-content">
          <p>"It requires a completely different mindset than the one used to program in Python."<br><br>Can you elaborate?  "RPython for Python programmers" would be an excellent addition to the docs or this blog. :)</p>
        </div>
      </div>
      <div class="comment comment-1866193735594487645">
        <div class="comment-header">
          <a name="comment-1866193735594487645"></a>
            <span class="author">Michael Foord</span> wrote on <span class="date">2008-01-21 16:14</span>:
        </div>
        <div class="comment-content">
          <p>I agree with Jonathan. There are many Python programmers who would *love* to be able to write Python extensions with RPython.<br><br>I know that this is already possible, but there are two issues:<br><br>* Lack of documentation on programming with RPython (I realise that this is a moving target)<br>* Last I heard, the refcounting implementation made RPython extensions inefficient<br><br>If these two issues were resolved (or mostly resolved) then a lot more people might start using the PyPy toolchain.<br><br>Asides from my growsing, it looks like PyPy is becoming more impressive by the day. Congratulations.</p>
        </div>
      </div>
      <div class="comment comment-6878620404584493138">
        <div class="comment-header">
          <a name="comment-6878620404584493138"></a>
            <span class="author">Leonardo Santagada</span> wrote on <span class="date">2008-01-21 16:20</span>:
        </div>
        <div class="comment-content">
          <p>As of today you can't write CPython extensions in RPython.<br><br>Why not ask for the great computer language shootout to include RPython as one of their benchmarking languages? This could be a good and free advertising for the pypy project.</p>
        </div>
      </div>
      <div class="comment comment-4803915553668560905">
        <div class="comment-header">
          <a name="comment-4803915553668560905"></a>
            <span class="author">Silveira Neto</span> wrote on <span class="date">2008-01-21 16:55</span>:
        </div>
        <div class="comment-content">
          <p>mmm<br>0.42<br>42<br>The answer...</p>
        </div>
      </div>
      <div class="comment comment-1679057019380130891">
        <div class="comment-header">
          <a name="comment-1679057019380130891"></a>
            <span class="author">Carl Friedrich Bolz-Tereick</span> wrote on <span class="date">2008-01-21 17:06</span>:
        </div>
        <div class="comment-content">
          <p>Hi Michael,<br><br>Leonardo is correct, the extension compiler was removed from SVN in November. We had many discussions about this step, but eventually it turned out to be necessary for many reasons. The extcompiler never was that useful in the first place because the produced extensions weren't fast (one of the reasons being the bad refcounting indeed).<br><br>The other reasons were that the extcompiler was impossible to maintain and was actually <i>preventing</i> progress, because it kept code alive that we wanted to get rid off.<br><br>So at the moment you cannot use PyPy any more to produce CPython extensions, only standalone programs.<br><br>It's completely possible that the extcompiler will be reborn in the future, but at the moment our priorities are really to make PyPy a good Python and not do tons of things on the side.<br><br>Cheers,<br><br>Carl Friedrich</p>
        </div>
      </div>
      <div class="comment comment-5040636442072863117">
        <div class="comment-header">
          <a name="comment-5040636442072863117"></a>
            <span class="author">Antonio Cuni</span> wrote on <span class="date">2008-01-21 18:06</span>:
        </div>
        <div class="comment-content">
          <p>I would also say nowadays it's already possible to write extension modules in RPython... but just for PyPy, now for CPython :-).<br><br>Jokes apart, if someone is really interested in writing part of its application in RPython (despite our warnings :-)), targeting PyPy could be an interesting alternative, as long as you don't need external libraries and the speed gain is more than what you loose in other areas where PyPy is actually slower.</p>
        </div>
      </div>
      <div class="comment comment-73623258163692113">
        <div class="comment-header">
          <a name="comment-73623258163692113"></a>
            <span class="author">Justin</span> wrote on <span class="date">2008-01-21 21:17</span>:
        </div>
        <div class="comment-content">
          <p>I think a lot of people are interested in using RPython for performance reasons. But about nobody will leave CPython atm, because extension modules are not working.<br><br>At the moment, I wouldn't leave CPython since all I am doing is heavily based on scipy. And so my only option is (a) to wait PyPy being able to compile extensions for CPython or (b) PyPy making use of CPython extensions.<br><br>As long as this is not going to happen, I probably will not use RPython for serious projects. :/</p>
        </div>
      </div>
      <div class="comment comment-4413697806677999824">
        <div class="comment-header">
          <a name="comment-4413697806677999824"></a>
            <span class="author">Isaac Gouy</span> wrote on <span class="date">2008-01-25 17:11</span>:
        </div>
        <div class="comment-content">
          <em>"Also the benchmark is very likely flawed because it favours better GCs :)"</em><br><br>Why would that be a flaw? <a href="https://shootout.alioth.debian.org/gp4sandbox/benchmark.php?test=binarytrees&amp;lang=all#about" rel="nofollow">Note: this is an adaptation of a benchmark for testing GC</a><br><br><br>Leonardo Santagada said <em>"Why not ask for the great computer language shootout to include RPython ..."</em><br><br><a href="https://shootout.alioth.debian.org/gp4sandbox/faq.php#acceptable" rel="nofollow">FAQ Why don't you include language X?</a>
        </div>
      </div>
      <div class="comment comment-678918830729292900">
        <div class="comment-header">
          <a name="comment-678918830729292900"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2008-01-25 21:03</span>:
        </div>
        <div class="comment-content">
          <p>Once the RPython was translated to C by PyPy how did you compile the C?</p>
        </div>
      </div>
      <div class="comment comment-3887525265919085904">
        <div class="comment-header">
          <a name="comment-3887525265919085904"></a>
            <span class="author">Maciej Fijalkowski</span> wrote on <span class="date">2008-01-25 21:31</span>:
        </div>
        <div class="comment-content">
          <p>&gt; Why would that be a flaw? Note: this is an adaptation of a benchmark for testing GC<br><br>I know, but I realised it after posting :) (We even have original somewhere around to compare gcs). Also, honestly a lot of python versions rely on libraries written in C, hence it took me a while that is "pure enough".<br><br>&gt; Once the RPython was translated to C by PyPy how did you compile the C?<br><br>With the very same options as bare gcc. -O3 -fomit-frame-pointer</p>
        </div>
      </div>
      <div class="comment comment-7339225691796216345">
        <div class="comment-header">
          <a name="comment-7339225691796216345"></a>
            <span class="author">Anonymous</span> wrote on <span class="date">2008-01-28 20:18</span>:
        </div>
        <div class="comment-content">
          <p>Did you try any of the other computer language shootout benchmarks?</p>
        </div>
      </div>
      <div class="comment comment-5942720140797805387">
        <div class="comment-header">
          <a name="comment-5942720140797805387"></a>
            <span class="author">_</span> wrote on <span class="date">2008-02-14 03:14</span>:
        </div>
        <div class="comment-content">
          <p>More objects != OO.<br><br>Perhaps you meant to say that it more closely reflects the domain?<br><br>No, I don't know how I ended up on this blog post.</p>
        </div>
      </div>
      <div class="comment comment-1884084792633767742">
        <div class="comment-header">
          <a name="comment-1884084792633767742"></a>
            <span class="author">Ariel Balter</span> wrote on <span class="date">2009-10-15 04:25</span>:
        </div>
        <div class="comment-content">
          <p>How does RPython compare to Python Shedskin?</p>
        </div>
      </div>
      <div class="comment comment-4442675677854997047">
        <div class="comment-header">
          <a name="comment-4442675677854997047"></a>
            <span class="author">Patric Dexheimer</span> wrote on <span class="date">2010-09-01 15:12</span>:
        </div>
        <div class="comment-content">
          <p>"Can you elaborate? "RPython for Python programmers" would be an excellent addition to the docs or this blog. :)"<br><br>+1 on this.<br><br>Greetings from Brazil!</p>
        </div>
      </div>
         </div>

          </section>
</div>
    <div class="sidebar">
<div>
  <h2>
    The PyPy blogposts
  </h2>
  <div>
    Create a guest post via a PR to the <a href="https://github.com/pypy/pypy.org">source repo</a>
  </div>
</div>
    <div id="global-recent-posts">
    <h2>
      Recent Posts
    </h2>
    <ul class="post-list">
      <li>
        <a href="/posts/2020/12/mac-meets-arm64-940822335619099039.html" class="listtitle">Mac meets Arm64</a>
      </li>
      <li>
        <a href="/posts/2020/11/pypy-733-triple-release-python-37-36-3446596804408262749.html" class="listtitle">PyPy 7.3.3 triple release: python 3.7, 3.6, and 2.7</a>
      </li>
      <li>
        <a href="/posts/2020/09/pypy-732-triple-release-python-27-36-3980901335490872787.html" class="listtitle">PyPy 7.3.2 triple release: python 2.7, 3.6, and 3.7</a>
      </li>
      <li>
        <a href="/posts/2020/08/pypy-is-on-open-collective-5673322428814364737.html" class="listtitle">PyPy is on Open Collective</a>
      </li>
      <li>
        <a href="/posts/2020/08/a-new-chapter-for-pypy-8388322709667328389.html" class="listtitle">A new chapter for PyPy</a>
      </li>
      <li>
        <a href="/posts/2020/04/pypy-731-released-6266451647387657480.html" class="listtitle">PyPy 7.3.1 released</a>
      </li>
      <li>
        <a href="/posts/2020/03/leysin-2020-sprint-report-764567777353955897.html" class="listtitle">Leysin 2020 Sprint Report</a>
      </li>
      <li>
        <a href="/posts/2020/02/pypy-and-cffi-have-moved-to-heptapod-5791595152472747032.html" class="listtitle">PyPy and CFFI have moved to Heptapod</a>
      </li>
      <li>
        <a href="/posts/2020/01/leysin-winter-sprint-2020-feb-28-march-6349761524797409012.html" class="listtitle">Leysin Winter sprint 2020: Feb 29 - March 8th</a>
      </li>
      <li>
        <a href="/posts/2019/12/pypy-730-released-3614026620096963655.html" class="listtitle">PyPy 7.3.0 released</a>
      </li>
    </ul>
  </div>

          <div id="global-archive-list">
          <h2>
            Archives
          </h2>
          <ul class="archive-level archive-level-1">
            <li><a class="reference" href="/2007/">2007</a> (19)
            </li>
            <li><a class="reference" href="/2008/">2008</a> (62)
            </li>
            <li><a class="reference" href="/2009/">2009</a> (38)
            </li>
            <li><a class="reference" href="/2010/">2010</a> (44)
            </li>
            <li><a class="reference" href="/2011/">2011</a> (43)
            </li>
            <li><a class="reference" href="/2012/">2012</a> (44)
            </li>
            <li><a class="reference" href="/2013/">2013</a> (46)
            </li>
            <li><a class="reference" href="/2014/">2014</a> (22)
            </li>
            <li><a class="reference" href="/2015/">2015</a> (20)
            </li>
            <li><a class="reference" href="/2016/">2016</a> (20)
            </li>
            <li><a class="reference" href="/2017/">2017</a> (13)
            </li>
            <li><a class="reference" href="/2018/">2018</a> (12)
            </li>
            <li><a class="reference" href="/2019/">2019</a> (12)
            </li>
            <li><a class="reference" href="/2020/">2020</a> (9)
            </li>
          </ul>
        </div>


          <div id="global-tag-list">
          <h2>
            Tags
          </h2>
          <ul>
            <li><a class="reference" href="/categories/arm.html">arm</a> (1)</li>
            <li><a class="reference" href="/categories/cli.html">cli</a> (1)</li>
            <li><a class="reference" href="/categories/compiler.html">compiler</a> (1)</li>
            <li><a class="reference" href="/categories/cpyext.html">cpyext</a> (3)</li>
            <li><a class="reference" href="/categories/cpython.html">CPython</a> (3)</li>
            <li><a class="reference" href="/categories/ep2008.html">ep2008</a> (1)</li>
            <li><a class="reference" href="/categories/extension-modules.html">extension modules</a> (2)</li>
            <li><a class="reference" href="/categories/graalpython.html">GraalPython</a> (1)</li>
            <li><a class="reference" href="/categories/hpy.html">hpy</a> (1)</li>
            <li><a class="reference" href="/categories/heptapod.html">Heptapod</a> (1)</li>
            <li><a class="reference" href="/categories/jit.html">jit</a> (18)</li>
            <li><a class="reference" href="/categories/jython.html">jython</a> (1)</li>
            <li><a class="reference" href="/categories/kcachegrind.html">kcachegrind</a> (1)</li>
            <li><a class="reference" href="/categories/numpy.html">numpy</a> (24)</li>
            <li><a class="reference" href="/categories/parser.html">parser</a> (1)</li>
            <li><a class="reference" href="/categories/profiling.html">profiling</a> (1)</li>
            <li><a class="reference" href="/categories/pypy.html">pypy</a> (6)</li>
            <li><a class="reference" href="/categories/pypy3.html">pypy3</a> (16)</li>
            <li><a class="reference" href="/categories/pyqt4.html">PyQt4</a> (1)</li>
            <li><a class="reference" href="/categories/release.html">release</a> (47)</li>
            <li><a class="reference" href="/categories/releasecffi.html">releasecffi</a> (3)</li>
            <li><a class="reference" href="/categories/releasepypy.html">releasepypy</a> (1)</li>
            <li><a class="reference" href="/categories/releaserevdb.html">releaserevdb</a> (1)</li>
            <li><a class="reference" href="/categories/releasestm.html">releasestm</a> (1)</li>
            <li><a class="reference" href="/categories/revdb.html">revdb</a> (1)</li>
            <li><a class="reference" href="/categories/roadmap.html">roadmap</a> (1)</li>
            <li><a class="reference" href="/categories/rpyc.html">RPyC</a> (1)</li>
            <li><a class="reference" href="/categories/speed.html">speed</a> (3)</li>
            <li><a class="reference" href="/categories/sprint.html">sprint</a> (3)</li>
            <li><a class="reference" href="/categories/stm.html">stm</a> (14)</li>
            <li><a class="reference" href="/categories/sun.html">sun</a> (1)</li>
            <li><a class="reference" href="/categories/smalltalk.html">Smalltalk</a> (1)</li>
            <li><a class="reference" href="/categories/squeak.html">Squeak</a> (1)</li>
            <li><a class="reference" href="/categories/unicode.html">unicode</a> (1)</li>
            <li><a class="reference" href="/categories/valgrind.html">valgrind</a> (1)</li>
          </ul>
        </div>    </div>
</article></main><footer id="footer"><p>
</p>
<div class="myfooter">
  <div>
    <img src="../../../images/pypy-logo-nav-grey.png" alt="PyPy Logo">
</div>
  <div class="logotext">
     Contents © 2021 <a href="mailto:pypy-dev@pypy.org">The PyPy Team</a>
    Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a> 
  </div>
  <div style="margin-left: auto">
  <a href="rss.xml">RSS feed</a>
</div>

            
        

    </div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" crossorigin="anonymous"></script><script src="../../../assets/js/styles.js"></script></footer>
</div>
</body>
</html>
