<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Finding Bugs in PyPy with a Fuzzer | PyPy</title>
<link href="../../../assets/css/rst_base.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_rst.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/styles.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://www.pypy.org/posts/2008/07/finding-bugs-in-pypy-with-fuz-7503072572107631526.html">
<link rel="icon" href="../../../favicon2.ico" sizes="16x16">
<link rel="icon" href="../../../favicon32x32.ico" sizes="32x32">
<!--[if lt IE 9]><script src="../../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
<meta name="author" content="The PyPy Team">
<link rel="prev" href="pypys-python-runs-pinax-django-1265543049596913506.html" title="PyPy's Python runs Pinax / Django" type="text/html">
<link rel="next" href="europython-2008-pypy-talks-and-sprint-2255727845041197411.html" title="Europython 2008 PyPy talks and sprint sum up" type="text/html">
<meta property="og:site_name" content="PyPy">
<meta property="og:title" content="Finding Bugs in PyPy with a Fuzzer">
<meta property="og:url" content="https://www.pypy.org/posts/2008/07/finding-bugs-in-pypy-with-fuz-7503072572107631526.html">
<meta property="og:description" content="Last week I played a bit with Fusil, which is a fuzzing framework.  The idea is
to feed the interpreter code that calls the functions of a module with random values
of various types as arguments in th">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2008-07-13T16:53:00Z">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
             <header id="header"><!-- Adapted from https://www.taniarascia.com/responsive-dropdown-navigation-bar --><section class="navigation"><div class="nav-container">
            <div class="brand">
                <a href="../../../index.html">
                    <image id="toplogo" src="../../../images/pypy-logo.svg" width="75px;" alt="PyPy/"></image></a>
            </div>
            <nav><ul class="nav-list">
<li> 
                <a href="#!">Features</a>
                <ul class="nav-dropdown">
<li> <a href="../../../features.html">What is PyPy?</a> </li>  
                    <li> <a href="../../../compat.html">Compatibility</a> </li>  
                    <li> <a href="../../../performance.html">Performance</a> </li>  
                </ul>
</li>
          <li> <a href="../../../download.html">Download</a> </li>  
          <li> <a href="http://doc.pypy.org">Dev Docs</a> </li>  
            <li> 
                <a href="#!">Blog</a>
                <ul class="nav-dropdown">
<li> <a href="../../../blog">Index</a> </li>  
                    <li> <a href="../../../categories">Tags</a> </li>  
                    <li> <a href="../../../archive.html">Archive by year</a> </li>  
                    <li> <a href="../../../rss.xml">RSS feed</a> </li>  
                    <li> <a href="https://morepypy.blogspot.com/">Old site</a> </li>  
                </ul>
</li>
            <li> 
                <a href="#!">About</a>
                <ul class="nav-dropdown">
<li> <a href="https://twitter.com/pypyproject">Twitter</a> </li>  
                    <li> <a href="https://quodlibet.duckdns.org/irc/pypy/latest.log.html#irc-end">IRC</a> </li>  
                    <li> <a href="../../../people.html">People</a> </li>  
                    <li> <a href="../../../howtohelp.html">How To Help?</a> </li>  
                    <li> <a href="../../../contact.html">Contact</a> </li>  
                </ul>
</li>

                </ul></nav><div class="nav-mobile">
                <a id="nav-toggle" href="#!"> <span></span></a>
            </div>
        </div>
    </section></header><main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><div class="post">
          <header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Finding Bugs in PyPy with a Fuzzer</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    The PyPy Team
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2008-07-13T16:53:00Z" itemprop="datePublished" title="2008-07-13 16:53">2008-07-13 16:53</time></a>
            </p>
            <p class="commentline">  5 comments
</p>
                <p class="commentline">                <a href="finding-bugs-in-pypy-with-fuz-7503072572107631526.html#utterances-thread">Comments</a>


            
        </p>
</div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
      <p>Last week I played a bit with <a class="reference" href="https://fusil.hachoir.org/trac">Fusil</a>, which is a <a class="reference" href="https://en.wikipedia.org/wiki/Fuzz_testing">fuzzing</a> framework.  The idea is
to feed the interpreter code that calls the functions of a module with random values
of various types as arguments in the hope that one hits an unchecked case. This is
done until a problem is hit , the most common problem being a segfault.  Victor Stinner,
the author of Fusil, is a regular in the PyPy IRC channel and thankfully helped me
getting started with Fusil. I used his project description for CPython as a starting
point and tweaked it a bit.  Reason is that PyPy is harder to segfault and so
I tweaked Fusil to also count uncaught RPython-level exceptions as such a problem.
(RPython has full exception support, and if an RPython-exception escapes to the top
level, the Python interpreter aborts.  One should not be able to exploit this but
but for a user it is bad enough, because such exceptions cannot be caught from
Python code.)</p>
<p>Using Fusil I found a number of cases where such exceptions happened (in some
pickle support-code, in the expat parser, in the <tt class="docutils literal"><span class="pre">os</span></tt> and in the <tt class="docutils literal"><span class="pre">termios</span></tt>
module) and also one or two segfaults (in the parser module, of all places).
I fixed all these problems so that by
now the fuzzer just runs for a very long time and only finds things that take
too long (so they count as a way to do a DoS attack) like
<tt class="docutils literal"><span class="pre">pow(12355123123L,</span> <span class="pre">12351512123121L)</span></tt> or <tt class="docutils literal"><span class="pre">round(1,</span> <span class="pre">1000000000)</span></tt> (the latter
should probably be fixed). This probably just means that the fuzzer is not good
enough, because there are certainly segfaults left in PyPy. However, the fact
that it is rather hard to find them validates our approach of using a
high-level memory-managed language for our interpreter. Victor tells me that it
is rather easy to find segfaults in CPython this way, he already found <a class="reference" href="https://bugs.python.org/issue?%40search_text=&amp;title=&amp;%40columns=title&amp;id=&amp;%40columns=id&amp;creation=&amp;creator=haypo&amp;activity=2008-07-06&amp;%40columns=activity&amp;%40sort=activity&amp;actor=&amp;nosy=&amp;type=&amp;components=&amp;versions=&amp;dependencies=&amp;assignee=&amp;keywords=&amp;priority=&amp;%40group=priority&amp;status=1&amp;%40columns=status&amp;resolution=&amp;%40pagesize=50&amp;%40startwith=0&amp;%40queryname=&amp;%40old-queryname=&amp;%40action=search">quite
some problems</a>.</p>
      </div>
      <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="pypys-python-runs-pinax-django-1265543049596913506.html" rel="prev" title="PyPy's Python runs Pinax / Django">Previous post</a>
            </li>
            <li class="next">
                <a href="europython-2008-pypy-talks-and-sprint-2255727845041197411.html" rel="next" title="Europython 2008 PyPy talks and sprint sum up">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
                <div class="comment-level comment-level-1">
      <div class="comment comment-6943777478376169632">
        <div class="comment-header">
          <a name="comment-6943777478376169632"></a>
            <span class="author">Marius Gedminas</span> wrote on <span class="date">2008-07-13 20:42</span>:
        </div>
        <div class="comment-content">
          <p>Nice post!<br><br>I especially like your certainty that PyPy has segfaults left in it. :-)</p>
        </div>
      </div>
      <div class="comment comment-6924439240468956191">
        <div class="comment-header">
          <a name="comment-6924439240468956191"></a>
            <span class="author">Maciej Fijalkowski</span> wrote on <span class="date">2008-07-13 22:02</span>:
        </div>
        <div class="comment-content">
          <p>What? Segfaults in PyPy? Shouldn't have any left by now :-)</p>
        </div>
      </div>
      <div class="comment comment-6943584948638181187">
        <div class="comment-header">
          <a name="comment-6943584948638181187"></a>
            <span class="author">Armin Rigo</span> wrote on <span class="date">2008-07-13 22:04</span>:
        </div>
        <div class="comment-content">
          <p>That previous comment was from me, accidentally logged in as Maciej, sorry.  As usual, in PyPy confusion comes for free.</p>
        </div>
      </div>
      <div class="comment comment-8490156991398913086">
        <div class="comment-header">
          <a name="comment-8490156991398913086"></a>
            <span class="author">Maciej Fijalkowski</span> wrote on <span class="date">2008-07-14 07:17</span>:
        </div>
        <div class="comment-content">
          <p>heh :) I was a bit surprised to see my comment which I did not write. Anyway, I agree with it :-)</p>
        </div>
      </div>
      <div class="comment comment-6000574086347701985">
        <div class="comment-header">
          <a name="comment-6000574086347701985"></a>
            <span class="author">Anonymous</span> wrote on <span class="date">2009-02-07 06:37</span>:
        </div>
        <div class="comment-content">
          <p>You said you will love me <a href="https://www.wowgoldvip.co.uk" rel="nofollow">wow gold</a> the whole life, but <a href="https://www.gogoer.com" rel="nofollow">WoW Gold</a> you marry her. You said you will <a href="https://www.wow-golds.net/power-leveling.asp" rel="nofollow">wow power leveling</a>,come to marry me, but this will not be carried out forever.<a href="https://www.wowgold-de.com" rel="nofollow">WoW Gold</a> I am trying my best to forget you and do not love you anymore. <a href="https://www.igsstar.com" rel="nofollow">wow leveling</a> But I failed and I still love you. Maybe <a href="https://www.powerlevelingweb.com" rel="nofollow">wow leveling</a> she needs you more compared  <a href="https://www.sf10001.cn" rel="nofollow">wow leveling</a> with me. So I tell you that <a href="https://www.sf10001.cn/wow-power-leveling-us-World-Of-Warcraft-gold/" rel="nofollow">world of warcraft power leveling</a> you should love <a href="https://www.powerlevelingweb.com/wow-powerleveling.asp" rel="nofollow">world of warcraft power leveling</a>  her and take good <a href="https://www.wow-powerleveling.org/wow+power+leveling.html" rel="nofollow">world of warcraft leveling</a> care of her. You said I was so kind.<a href="https://www.igsstar.com/wow-powerleveling-us/" rel="nofollow">world of warcraft leveling</a> Yes, because I love you,<a href="https://www.xowow.com/wow-powerleveling.asp" rel="nofollow">world of warcraft leveling</a> I hope you will be <a href="https://www.superpowerleveling.com" rel="nofollow">power leveling</a> happy forever.</p>
        </div>
      </div>
         </div>

          </section>
</div>
    <div class="sidebar">
<div>
  <h2>
    The PyPy blogposts
  </h2>
  <div>
    Create a guest post via a PR to the <a href="https://github.com/pypy/pypy.org">source repo</a>
  </div>
</div>
    <div id="global-recent-posts">
    <h2>
      Recent Posts
    </h2>
    <ul class="post-list">
      <li>
        <a href="/posts/2020/12/mac-meets-arm64-940822335619099039.html" class="listtitle">Mac meets Arm64</a>
      </li>
      <li>
        <a href="/posts/2020/11/pypy-733-triple-release-python-37-36-3446596804408262749.html" class="listtitle">PyPy 7.3.3 triple release: python 3.7, 3.6, and 2.7</a>
      </li>
      <li>
        <a href="/posts/2020/09/pypy-732-triple-release-python-27-36-3980901335490872787.html" class="listtitle">PyPy 7.3.2 triple release: python 2.7, 3.6, and 3.7</a>
      </li>
      <li>
        <a href="/posts/2020/08/pypy-is-on-open-collective-5673322428814364737.html" class="listtitle">PyPy is on Open Collective</a>
      </li>
      <li>
        <a href="/posts/2020/08/a-new-chapter-for-pypy-8388322709667328389.html" class="listtitle">A new chapter for PyPy</a>
      </li>
      <li>
        <a href="/posts/2020/04/pypy-731-released-6266451647387657480.html" class="listtitle">PyPy 7.3.1 released</a>
      </li>
      <li>
        <a href="/posts/2020/03/leysin-2020-sprint-report-764567777353955897.html" class="listtitle">Leysin 2020 Sprint Report</a>
      </li>
      <li>
        <a href="/posts/2020/02/pypy-and-cffi-have-moved-to-heptapod-5791595152472747032.html" class="listtitle">PyPy and CFFI have moved to Heptapod</a>
      </li>
      <li>
        <a href="/posts/2020/01/leysin-winter-sprint-2020-feb-28-march-6349761524797409012.html" class="listtitle">Leysin Winter sprint 2020: Feb 29 - March 8th</a>
      </li>
      <li>
        <a href="/posts/2019/12/pypy-730-released-3614026620096963655.html" class="listtitle">PyPy 7.3.0 released</a>
      </li>
    </ul>
  </div>

          <div id="global-archive-list">
          <h2>
            Archives
          </h2>
          <ul class="archive-level archive-level-1">
            <li><a class="reference" href="/2007/">2007</a> (19)
            </li>
            <li><a class="reference" href="/2008/">2008</a> (62)
            </li>
            <li><a class="reference" href="/2009/">2009</a> (38)
            </li>
            <li><a class="reference" href="/2010/">2010</a> (44)
            </li>
            <li><a class="reference" href="/2011/">2011</a> (43)
            </li>
            <li><a class="reference" href="/2012/">2012</a> (44)
            </li>
            <li><a class="reference" href="/2013/">2013</a> (46)
            </li>
            <li><a class="reference" href="/2014/">2014</a> (22)
            </li>
            <li><a class="reference" href="/2015/">2015</a> (20)
            </li>
            <li><a class="reference" href="/2016/">2016</a> (20)
            </li>
            <li><a class="reference" href="/2017/">2017</a> (13)
            </li>
            <li><a class="reference" href="/2018/">2018</a> (12)
            </li>
            <li><a class="reference" href="/2019/">2019</a> (12)
            </li>
            <li><a class="reference" href="/2020/">2020</a> (9)
            </li>
          </ul>
        </div>


          <div id="global-tag-list">
          <h2>
            Tags
          </h2>
          <ul>
            <li><a class="reference" href="/categories/arm.html">arm</a> (1)</li>
            <li><a class="reference" href="/categories/cli.html">cli</a> (1)</li>
            <li><a class="reference" href="/categories/compiler.html">compiler</a> (1)</li>
            <li><a class="reference" href="/categories/cpyext.html">cpyext</a> (3)</li>
            <li><a class="reference" href="/categories/cpython.html">CPython</a> (3)</li>
            <li><a class="reference" href="/categories/ep2008.html">ep2008</a> (1)</li>
            <li><a class="reference" href="/categories/extension-modules.html">extension modules</a> (2)</li>
            <li><a class="reference" href="/categories/graalpython.html">GraalPython</a> (1)</li>
            <li><a class="reference" href="/categories/hpy.html">hpy</a> (1)</li>
            <li><a class="reference" href="/categories/heptapod.html">Heptapod</a> (1)</li>
            <li><a class="reference" href="/categories/jit.html">jit</a> (18)</li>
            <li><a class="reference" href="/categories/jython.html">jython</a> (1)</li>
            <li><a class="reference" href="/categories/kcachegrind.html">kcachegrind</a> (1)</li>
            <li><a class="reference" href="/categories/numpy.html">numpy</a> (24)</li>
            <li><a class="reference" href="/categories/parser.html">parser</a> (1)</li>
            <li><a class="reference" href="/categories/profiling.html">profiling</a> (1)</li>
            <li><a class="reference" href="/categories/pypy.html">pypy</a> (6)</li>
            <li><a class="reference" href="/categories/pypy3.html">pypy3</a> (16)</li>
            <li><a class="reference" href="/categories/pyqt4.html">PyQt4</a> (1)</li>
            <li><a class="reference" href="/categories/release.html">release</a> (47)</li>
            <li><a class="reference" href="/categories/releasecffi.html">releasecffi</a> (3)</li>
            <li><a class="reference" href="/categories/releasepypy.html">releasepypy</a> (1)</li>
            <li><a class="reference" href="/categories/releaserevdb.html">releaserevdb</a> (1)</li>
            <li><a class="reference" href="/categories/releasestm.html">releasestm</a> (1)</li>
            <li><a class="reference" href="/categories/revdb.html">revdb</a> (1)</li>
            <li><a class="reference" href="/categories/roadmap.html">roadmap</a> (1)</li>
            <li><a class="reference" href="/categories/rpyc.html">RPyC</a> (1)</li>
            <li><a class="reference" href="/categories/speed.html">speed</a> (3)</li>
            <li><a class="reference" href="/categories/sprint.html">sprint</a> (3)</li>
            <li><a class="reference" href="/categories/stm.html">stm</a> (14)</li>
            <li><a class="reference" href="/categories/sun.html">sun</a> (1)</li>
            <li><a class="reference" href="/categories/smalltalk.html">Smalltalk</a> (1)</li>
            <li><a class="reference" href="/categories/squeak.html">Squeak</a> (1)</li>
            <li><a class="reference" href="/categories/unicode.html">unicode</a> (1)</li>
            <li><a class="reference" href="/categories/valgrind.html">valgrind</a> (1)</li>
          </ul>
        </div>    </div>
</article></main><footer id="footer"><p>
</p>
<div class="myfooter">
  <div>
    <img src="../../../images/pypy-logo-nav-grey.png" alt="PyPy Logo">
</div>
  <div class="logotext">
     Contents © 2021 <a href="mailto:pypy-dev@pypy.org">The PyPy Team</a>
    Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a> 
  </div>
  <div style="margin-left: auto">
  <a href="rss.xml">RSS feed</a>
</div>

            
        

    </div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" crossorigin="anonymous"></script><script src="../../../assets/js/styles.js"></script></footer>
</div>
</body>
</html>
