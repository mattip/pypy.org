<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PyPy gets a new compiler | PyPy</title>
<link href="../../../assets/css/rst_base.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_rst.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/styles.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://www.pypy.org/posts/2009/08/pypy-gets-new-compiler_25-6401910947439531107.html">
<link rel="icon" href="../../../favicon2.ico" sizes="16x16">
<link rel="icon" href="../../../favicon32x32.ico" sizes="32x32">
<!--[if lt IE 9]><script src="../../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
<meta name="author" content="The PyPy Team">
<link rel="prev" href="gothenburg-jit-sprint-report-3309138497953458138.html" title="Gothenburg JIT sprint report" type="text/html">
<link rel="next" href="../09/pypy-sprint-in-dusseldorf-6-nov-13-nov-8153983964308175836.html" title="PyPy sprint in Düsseldorf, 6 Nov - 13 Nov" type="text/html">
<meta property="og:site_name" content="PyPy">
<meta property="og:title" content="PyPy gets a new compiler">
<meta property="og:url" content="https://www.pypy.org/posts/2009/08/pypy-gets-new-compiler_25-6401910947439531107.html">
<meta property="og:description" content="Today, I merged the parser-compiler branch, which I have been working on over the summer. It contained a total rewrite of both PyPy's Python parser and AST compiler. PyPy's old parser was (in)famous i">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2009-08-25T16:05:00Z">
<meta property="article:tag" content="compiler">
<meta property="article:tag" content="parser">
<meta property="article:tag" content="speed">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
             <header id="header"><!-- Adapted from https://www.taniarascia.com/responsive-dropdown-navigation-bar --><section class="navigation"><div class="nav-container">
            <div class="brand">
                <a href="../../../index.html">
                    <image id="toplogo" src="../../../images/pypy-logo.svg" width="75px;" alt="PyPy/"></image></a>
            </div>
            <nav><ul class="nav-list">
<li> 
                <a href="#!">Features</a>
                <ul class="nav-dropdown">
<li> <a href="../../../features.html">What is PyPy?</a> </li>  
                    <li> <a href="../../../compat.html">Compatibility</a> </li>  
                    <li> <a href="../../../performance.html">Performance</a> </li>  
                </ul>
</li>
          <li> <a href="../../../download.html">Download</a> </li>  
          <li> <a href="http://doc.pypy.org">Dev Docs</a> </li>  
            <li> 
                <a href="#!">Blog</a>
                <ul class="nav-dropdown">
<li> <a href="../../../blog">Index</a> </li>  
                    <li> <a href="../../../categories">Tags</a> </li>  
                    <li> <a href="../../../archive.html">Archive by year</a> </li>  
                    <li> <a href="../../../rss.xml">RSS feed</a> </li>  
                    <li> <a href="https://morepypy.blogspot.com/">Old site</a> </li>  
                </ul>
</li>
            <li> 
                <a href="#!">About</a>
                <ul class="nav-dropdown">
<li> <a href="https://twitter.com/pypyproject">Twitter</a> </li>  
                    <li> <a href="https://quodlibet.duckdns.org/irc/pypy/latest.log.html#irc-end">IRC</a> </li>  
                    <li> <a href="../../../people.html">People</a> </li>  
                    <li> <a href="../../../howtohelp.html">How To Help?</a> </li>  
                    <li> <a href="../../../contact.html">Contact</a> </li>  
                </ul>
</li>

                </ul></nav><div class="nav-mobile">
                <a id="nav-toggle" href="#!"> <span></span></a>
            </div>
        </div>
    </section></header><main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><div class="post">
          <header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">PyPy gets a new compiler</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    The PyPy Team
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2009-08-25T16:05:00Z" itemprop="datePublished" title="2009-08-25 16:05">2009-08-25 16:05</time></a>
            </p>
            <p class="commentline">  12 comments
</p>
                <p class="commentline">                <a href="pypy-gets-new-compiler_25-6401910947439531107.html#utterances-thread">Comments</a>


            
        </p>
</div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
      <p>Today, I merged the parser-compiler branch, which I have been working on over the summer. It contained a total rewrite of both PyPy's Python parser and AST compiler. PyPy's old parser was (in)famous internally for being complicated and slow (with many algorithmic complexities greater than O(n)). The new parser is a simple as <a href="https://codespeak.net/viewvc/pypy/trunk/pypy/interpreter/pyparser/parser.py?view=markup">I could make it</a> LL(1) parser like CPython (though it doesn't share the hacks of CPython's parser).</p>

<p>The new compiler is based on the <a href="https://doc.python.org/3.1/library/ast">Abstract Syntax Trees (AST) that CPython 2.5 introduced</a> instead of PyPy's old AST based on the <a href="https://doc.python.org/library/compiler">compiler package's</a>. This means that Python code running on PyPy will be able to use the same _ast interface as CPython. PyPy's _ast implementation supports AST features that CPython 2.6 added, including <a href="https://pythonic.pocoo.org/2008/3/29/ast-compilation-from-python">compiling modified AST to bytecode and executing it</a>. In this rewrite, some more obscure compiler features were added, too. For example, jumps in bytecode can now be greater than 65535 bytes! (That's like an if statement with 7000 lines of code in the body.)</p>

<p>While the PyPy translation toolchain still has many obscure details and hacks, this merge completes the process of making the actual Python interpreter very clean. Hopefully, this will make adding new features much easier and make PyPy less frustrating to maintain as well as providing application level code with an improved AST interface!</p>
      </div>
      <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../categories/compiler.html" rel="tag">compiler</a></li>
            <li><a class="tag p-category" href="../../../categories/parser.html" rel="tag">parser</a></li>
            <li><a class="tag p-category" href="../../../categories/speed.html" rel="tag">speed</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="gothenburg-jit-sprint-report-3309138497953458138.html" rel="prev" title="Gothenburg JIT sprint report">Previous post</a>
            </li>
            <li class="next">
                <a href="../09/pypy-sprint-in-dusseldorf-6-nov-13-nov-8153983964308175836.html" rel="next" title="PyPy sprint in Düsseldorf, 6 Nov - 13 Nov">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
                <div class="comment-level comment-level-1">
      <div class="comment comment-3273478940378309125">
        <div class="comment-header">
          <a name="comment-3273478940378309125"></a>
            <span class="author">Jeremy Cowles</span> wrote on <span class="date">2009-08-25 23:03</span>:
        </div>
        <div class="comment-content">
          <p>Nice, keep up the good work!</p>
        </div>
      </div>
      <div class="comment comment-6927050713039246876">
        <div class="comment-header">
          <a name="comment-6927050713039246876"></a>
            <span class="author">Anonymous</span> wrote on <span class="date">2009-08-26 08:12</span>:
        </div>
        <div class="comment-content">
          <p>Thank you.. Keep it up.</p>
        </div>
      </div>
      <div class="comment comment-3298144794898166018">
        <div class="comment-header">
          <a name="comment-3298144794898166018"></a>
            <span class="author">random user</span> wrote on <span class="date">2009-08-26 17:52</span>:
        </div>
        <div class="comment-content">
          <p>Very nice. Thanks for all of your work!</p>
        </div>
      </div>
      <div class="comment comment-923006735365767212">
        <div class="comment-header">
          <a name="comment-923006735365767212"></a>
            <span class="author">tobami</span> wrote on <span class="date">2009-08-31 10:43</span>:
        </div>
        <div class="comment-content">
          <p>Hi, the Gothenburg sprint news are very interesting.<br><br>What are your thoughts about a release roadmap?. Do you intend to release a pypy 1.2 with improved compatibility and speed but no JIT, and later include the JIT (version 1.5, maybe?)?.<br><br>I think publishing some kind of roadmap would be useful, as a project suffers when its release cycles are BOTH long and unpredictable.</p>
        </div>
      </div>
      <div class="comment comment-3472126299057732284">
        <div class="comment-header">
          <a name="comment-3472126299057732284"></a>
            <span class="author">tobami</span> wrote on <span class="date">2009-08-31 10:51</span>:
        </div>
        <div class="comment-content">
          <p>Also, starting from the next stable release, it would be great to publish some kind of benchmarks page to keep track of performance across different versions (cpython 2.6 vs pypy 1.1 vs pypy 1.2 vs pypy with JIT).<br><br>Now that I think of it, do you need some kind of help with the website?. I think starting with the next pypy's release, the project will get a lot more visibility and a nicer and better structured website would be a definite plus. If you feel it would be a useful task I could help there.</p>
        </div>
      </div>
      <div class="comment comment-4957196286966025819">
        <div class="comment-header">
          <a name="comment-4957196286966025819"></a>
            <span class="author">Maciej Fijalkowski</span> wrote on <span class="date">2009-08-31 16:05</span>:
        </div>
        <div class="comment-content">
          <p>Hey.<br><br>Both, the benchmarks (that would also include say jython) and a nice website for people who actually want to use it would be a very nice addon. We definitely would appreciate some help with it.<br><br>If you have any ideas feel free to continue discussion on pypy-dev.<br><br>Cheers,<br>fijal</p>
        </div>
      </div>
      <div class="comment comment-6904754859052187255">
        <div class="comment-header">
          <a name="comment-6904754859052187255"></a>
            <span class="author">tobami</span> wrote on <span class="date">2009-08-31 21:46</span>:
        </div>
        <div class="comment-content">
          <p>Hi Maciej, as you suggested, I have subscribed to the pypy-dev mailing list and have started the discussion.<br><br>Cheers,<br><br>Miquel</p>
        </div>
      </div>
      <div class="comment comment-1620704600946840791">
        <div class="comment-header">
          <a name="comment-1620704600946840791"></a>
            <span class="author">Maciej Fijalkowski</span> wrote on <span class="date">2009-09-01 15:47</span>:
        </div>
        <div class="comment-content">
          <p>Hey Miguel.<br><br>I fail to see your post.<br><br>Cheers,<br>fijal</p>
        </div>
      </div>
      <div class="comment comment-931506469715637732">
        <div class="comment-header">
          <a name="comment-931506469715637732"></a>
            <span class="author">tobami</span> wrote on <span class="date">2009-09-02 10:28</span>:
        </div>
        <div class="comment-content">
          <p>it got rejected. I have written to pypy-dev-owner to see where the problem is.<br><br>Cheers</p>
        </div>
      </div>
      <div class="comment comment-1641159585896558415">
        <div class="comment-header">
          <a name="comment-1641159585896558415"></a>
            <span class="author">Maciej Fijalkowski</span> wrote on <span class="date">2009-09-05 10:13</span>:
        </div>
        <div class="comment-content">
          <p>@tobami<br><br>you should subscribe to the list first.<br>We get far too much spam to accept<br>posts from non-members.<br><br>Cheers,<br>fijal</p>
        </div>
      </div>
      <div class="comment comment-5075986302530640169">
        <div class="comment-header">
          <a name="comment-5075986302530640169"></a>
            <span class="author">tobami</span> wrote on <span class="date">2009-09-05 21:21</span>:
        </div>
        <div class="comment-content">
          <p>@Maciej,<br><br>well, I subscribed first, that is the problem. I now get sent the pypy-dev mailing list, but my post got rejected anyway. And pypy-owner hasn't answered yet.<br><br>What can I do?</p>
        </div>
      </div>
      <div class="comment comment-6638185797274925771">
        <div class="comment-header">
          <a name="comment-6638185797274925771"></a>
            <span class="author">Maciej Fijalkowski</span> wrote on <span class="date">2009-09-06 19:57</span>:
        </div>
        <div class="comment-content">
          <p>@tobami<br><br>you did something wrong. pypy-dev<br>is not a moderated list (from<br>members, that is). Can you leave your mail, so we can no longer spam here? Mine is fijal at merlinux.eu</p>
        </div>
      </div>
         </div>

          </section>
</div>
    <div class="sidebar">
<div>
  <h2>
    The PyPy blogposts
  </h2>
  <div>
    Create a guest post via a PR to the <a href="https://github.com/pypy/pypy.org">source repo</a>
  </div>
</div>
    <div id="global-recent-posts">
    <h2>
      Recent Posts
    </h2>
    <ul class="post-list">
      <li>
        <a href="/posts/2020/12/mac-meets-arm64-940822335619099039.html" class="listtitle">Mac meets Arm64</a>
      </li>
      <li>
        <a href="/posts/2020/11/pypy-733-triple-release-python-37-36-3446596804408262749.html" class="listtitle">PyPy 7.3.3 triple release: python 3.7, 3.6, and 2.7</a>
      </li>
      <li>
        <a href="/posts/2020/09/pypy-732-triple-release-python-27-36-3980901335490872787.html" class="listtitle">PyPy 7.3.2 triple release: python 2.7, 3.6, and 3.7</a>
      </li>
      <li>
        <a href="/posts/2020/08/pypy-is-on-open-collective-5673322428814364737.html" class="listtitle">PyPy is on Open Collective</a>
      </li>
      <li>
        <a href="/posts/2020/08/a-new-chapter-for-pypy-8388322709667328389.html" class="listtitle">A new chapter for PyPy</a>
      </li>
      <li>
        <a href="/posts/2020/04/pypy-731-released-6266451647387657480.html" class="listtitle">PyPy 7.3.1 released</a>
      </li>
      <li>
        <a href="/posts/2020/03/leysin-2020-sprint-report-764567777353955897.html" class="listtitle">Leysin 2020 Sprint Report</a>
      </li>
      <li>
        <a href="/posts/2020/02/pypy-and-cffi-have-moved-to-heptapod-5791595152472747032.html" class="listtitle">PyPy and CFFI have moved to Heptapod</a>
      </li>
      <li>
        <a href="/posts/2020/01/leysin-winter-sprint-2020-feb-28-march-6349761524797409012.html" class="listtitle">Leysin Winter sprint 2020: Feb 29 - March 8th</a>
      </li>
      <li>
        <a href="/posts/2019/12/pypy-730-released-3614026620096963655.html" class="listtitle">PyPy 7.3.0 released</a>
      </li>
    </ul>
  </div>

          <div id="global-archive-list">
          <h2>
            Archives
          </h2>
          <ul class="archive-level archive-level-1">
            <li><a class="reference" href="/2007/">2007</a> (19)
            </li>
            <li><a class="reference" href="/2008/">2008</a> (62)
            </li>
            <li><a class="reference" href="/2009/">2009</a> (38)
            </li>
            <li><a class="reference" href="/2010/">2010</a> (44)
            </li>
            <li><a class="reference" href="/2011/">2011</a> (43)
            </li>
            <li><a class="reference" href="/2012/">2012</a> (44)
            </li>
            <li><a class="reference" href="/2013/">2013</a> (46)
            </li>
            <li><a class="reference" href="/2014/">2014</a> (22)
            </li>
            <li><a class="reference" href="/2015/">2015</a> (20)
            </li>
            <li><a class="reference" href="/2016/">2016</a> (20)
            </li>
            <li><a class="reference" href="/2017/">2017</a> (13)
            </li>
            <li><a class="reference" href="/2018/">2018</a> (12)
            </li>
            <li><a class="reference" href="/2019/">2019</a> (12)
            </li>
            <li><a class="reference" href="/2020/">2020</a> (9)
            </li>
          </ul>
        </div>


          <div id="global-tag-list">
          <h2>
            Tags
          </h2>
          <ul>
            <li><a class="reference" href="/categories/arm.html">arm</a> (1)</li>
            <li><a class="reference" href="/categories/cli.html">cli</a> (1)</li>
            <li><a class="reference" href="/categories/compiler.html">compiler</a> (1)</li>
            <li><a class="reference" href="/categories/cpyext.html">cpyext</a> (3)</li>
            <li><a class="reference" href="/categories/cpython.html">CPython</a> (3)</li>
            <li><a class="reference" href="/categories/ep2008.html">ep2008</a> (1)</li>
            <li><a class="reference" href="/categories/extension-modules.html">extension modules</a> (2)</li>
            <li><a class="reference" href="/categories/graalpython.html">GraalPython</a> (1)</li>
            <li><a class="reference" href="/categories/hpy.html">hpy</a> (1)</li>
            <li><a class="reference" href="/categories/heptapod.html">Heptapod</a> (1)</li>
            <li><a class="reference" href="/categories/jit.html">jit</a> (18)</li>
            <li><a class="reference" href="/categories/jython.html">jython</a> (1)</li>
            <li><a class="reference" href="/categories/kcachegrind.html">kcachegrind</a> (1)</li>
            <li><a class="reference" href="/categories/numpy.html">numpy</a> (24)</li>
            <li><a class="reference" href="/categories/parser.html">parser</a> (1)</li>
            <li><a class="reference" href="/categories/profiling.html">profiling</a> (1)</li>
            <li><a class="reference" href="/categories/pypy.html">pypy</a> (6)</li>
            <li><a class="reference" href="/categories/pypy3.html">pypy3</a> (16)</li>
            <li><a class="reference" href="/categories/pyqt4.html">PyQt4</a> (1)</li>
            <li><a class="reference" href="/categories/release.html">release</a> (47)</li>
            <li><a class="reference" href="/categories/releasecffi.html">releasecffi</a> (3)</li>
            <li><a class="reference" href="/categories/releasepypy.html">releasepypy</a> (1)</li>
            <li><a class="reference" href="/categories/releaserevdb.html">releaserevdb</a> (1)</li>
            <li><a class="reference" href="/categories/releasestm.html">releasestm</a> (1)</li>
            <li><a class="reference" href="/categories/revdb.html">revdb</a> (1)</li>
            <li><a class="reference" href="/categories/roadmap.html">roadmap</a> (1)</li>
            <li><a class="reference" href="/categories/rpyc.html">RPyC</a> (1)</li>
            <li><a class="reference" href="/categories/speed.html">speed</a> (3)</li>
            <li><a class="reference" href="/categories/sprint.html">sprint</a> (3)</li>
            <li><a class="reference" href="/categories/stm.html">stm</a> (14)</li>
            <li><a class="reference" href="/categories/sun.html">sun</a> (1)</li>
            <li><a class="reference" href="/categories/smalltalk.html">Smalltalk</a> (1)</li>
            <li><a class="reference" href="/categories/squeak.html">Squeak</a> (1)</li>
            <li><a class="reference" href="/categories/unicode.html">unicode</a> (1)</li>
            <li><a class="reference" href="/categories/valgrind.html">valgrind</a> (1)</li>
          </ul>
        </div>    </div>
</article></main><footer id="footer"><p>
</p>
<div class="myfooter">
  <div>
    <img src="../../../images/pypy-logo-nav-grey.png" alt="PyPy Logo">
</div>
  <div class="logotext">
     Contents © 2021 <a href="mailto:pypy-dev@pypy.org">The PyPy Team</a>
    Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a> 
  </div>
  <div style="margin-left: auto">
  <a href="rss.xml">RSS feed</a>
</div>

            
        

    </div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" crossorigin="anonymous"></script><script src="../../../assets/js/styles.js"></script></footer>
</div>
</body>
</html>
