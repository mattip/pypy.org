<!DOCTYPE html>
<html prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>A JIT Backend for ARM Processors | PyPy</title>
<link href="../../../assets/css/rst_base.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_rst.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/styles.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://www.pypy.org/posts/2011/01/jit-backend-for-arm-processors-5994810755839586463.html">
<link rel="icon" href="../../../favicon2.ico" sizes="16x16">
<link rel="icon" href="../../../favicon32x32.ico" sizes="32x32">
<!--[if lt IE 9]><script src="../../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
<meta name="author" content="The PyPy Team">
<link rel="prev" href="pypy-wants-you-4543209863582915733.html" title="PyPy wants you!" type="text/html">
<link rel="next" href="../02/pypy-faster-than-c-on-carefully-crafted-5614784244310486765.html" title="PyPy faster than C on a carefully crafted example" type="text/html">
<meta property="og:site_name" content="PyPy">
<meta property="og:title" content="A JIT Backend for ARM Processors">
<meta property="og:url" content="https://www.pypy.org/posts/2011/01/jit-backend-for-arm-processors-5994810755839586463.html">
<meta property="og:description" content="In the past few months, I have been developing as a part of my master thesis
the ARM backend for the the PyPy JIT, in the arm-backend branch. Currently, it is still work in progress: all integer and o">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2011-01-29T14:19:00Z">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
             <header id="header"><!-- Adapted from https://www.taniarascia.com/responsive-dropdown-navigation-bar --><section class="navigation"><div class="nav-container">
            <div class="brand">
                <a href="../../../index.html">
                    <image id="toplogo" src="../../../images/pypy-logo.svg" width="75px;" alt="PyPy/"></image></a>
            </div>
            <nav><ul class="nav-list">
<li> 
                <a href="#!">Features</a>
                <ul class="nav-dropdown">
<li> <a href="../../../features.html">What is PyPy?</a> </li>  
                    <li> <a href="../../../compat.html">Compatibility</a> </li>  
                    <li> <a href="../../../performance.html">Performance</a> </li>  
                </ul>
</li>
          <li> <a href="../../../download.html">Download</a> </li>  
          <li> <a href="http://doc.pypy.org">Dev Docs</a> </li>  
            <li> 
                <a href="#!">Blog</a>
                <ul class="nav-dropdown">
<li> <a href="../../../blog">Index</a> </li>  
                    <li> <a href="../../../categories">Tags</a> </li>  
                    <li> <a href="../../../archive.html">Archive by year</a> </li>  
                    <li> <a href="../../../rss.xml">RSS feed</a> </li>  
                    <li> <a href="https://morepypy.blogspot.com/">Old site</a> </li>  
                </ul>
</li>
            <li> 
                <a href="#!">About</a>
                <ul class="nav-dropdown">
<li> <a href="https://twitter.com/pypyproject">Twitter</a> </li>  
                    <li> <a href="https://quodlibet.duckdns.org/irc/pypy/latest.log.html#irc-end">IRC</a> </li>  
                    <li> <a href="../../../people.html">People</a> </li>  
                    <li> <a href="../../../howtohelp.html">How To Help?</a> </li>  
                    <li> <a href="../../../contact.html">Contact</a> </li>  
                </ul>
</li>

                </ul></nav><div class="nav-mobile">
                <a id="nav-toggle" href="#!"> <span></span></a>
            </div>
        </div>
    </section></header><main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><div class="post">
          <header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">A JIT Backend for ARM Processors</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    The PyPy Team
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2011-01-29T14:19:00Z" itemprop="datePublished" title="2011-01-29 14:19">2011-01-29 14:19</time></a>
            </p>
            <p class="commentline">  10 comments
</p>
                <p class="commentline">                <a href="jit-backend-for-arm-processors-5994810755839586463.html#utterances-thread">Comments</a>


            
        </p>
</div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
      <div class="document" id="a-jit-backend-for-arm-processors">
In the past few months, I have been developing as a part of my master thesis
the ARM backend for the the PyPy JIT, in the <a class="reference external" href="https://foss.heptapod.net/pypy/pypy/-/tree/branch/arm-backend-2">arm-backend</a> branch. Currently, it is still work in progress: all integer and object operations are working and
the support for <a class="reference external" href="https://foss.heptapod.net/pypy/pypy/-/tree/branch/arm-backed-float">floating point</a> is also under development.<br>
ARM processors are very widely used, beeing deployed in servers, some netbooks
and mainly mobile devices such as phones and tablets. One of our goals is to be
able to run PyPy on phones, specially on Android. Currently is not yet possible
to translate and compile PyPy for Android automatically, but there has been
some <a class="reference external" href="https://pyppet.blogspot.com/2011/01/android-and-rpython.html">work</a>  on using Android's NDK to compile PyPy's generated C code.<br>
The JIT Backend targets the application profile of the ARMv7 instruction set
architecture which is found for example in the Cortex-A8 processors used in many Android powered devices and in Apple's <a class="reference external" href="https://en.wikipedia.org/wiki/Apple_A4">A4 processors</a> built into the latest iOS devices. To develop and
test the backend we are using a <a class="reference external" href="https://beagleboard.org/hardware-xM">BeagleBoard-xM</a> which has a 1 GHz ARM
Cortex-A8 and 512 MB of RAM running the <a class="reference external" href="https://wiki.ubuntu.com/ARM">ARM port</a> of Ubuntu 10.10.<br>
Currently on Linux it is possible to translate and cross-compile PyPy's Python
interpreter as well as other interpreters with the ARM JIT backend enabled
using Scratchbox 2 to provide a build environment and the GNU ARM cross
compilation toolchain. So far the backend only supports the <a class="reference external" href="https://www.hpl.hp.com/personal/Hans_Boehm/gc/">Boehm</a> garbage
collector which does not produce the best results combined with the JIT, but we
plan to add support for the other GCs in the future, doing so should increase
the performance of PyPy on ARM.<br>
While still debugging the last issues with the backend we already can run some
simple benchmarks on <a class="reference external" href="https://bitbucket.org/cfbolz/pyrolog">Pyrolog</a>, a prolog interpreter written in RPython.
Even using Boehm as the GC the results look very promising. In the benchmarks
we compare Pyrolog to <a class="reference external" href="https://www.swi-prolog.org/">SWI-Prolog</a>, a prolog interpreter written in C, which
is available from the package repositories for Ubuntu's ARM port.<br>
The benchmarks can be found in the <a class="reference external" href="https://bitbucket.org/cfbolz/pyrolog-benchmark">pyrolog-bench</a> repository.<br><table border="1" class="docutils">
<colgroup></colgroup>
<colgroup><col width="32%"></colgroup>
<colgroup><col width="30%"></colgroup>
<colgroup><col width="25%"></colgroup>
<colgroup><col width="13%"></colgroup>
<thead valign="bottom"><tr>
<th class="head">Benchmark</th>
<th class="head">SWI-Prolog in ms.</th>
<th class="head">Pyrolog in ms.</th>
<th class="head">Speedup</th>
</tr></thead>
<tbody valign="top">
<tr>
<td>iterate</td>
<td>60.0</td>
<td>6.0</td>
<td>10.0</td>
</tr>
<tr>
<td>iterate_assert</td>
<td>130.0</td>
<td>6.0</td>
<td>21.67</td>
</tr>
<tr>
<td>iterate_call</td>
<td>3310.0</td>
<td>5.0</td>
<td>662.0</td>
</tr>
<tr>
<td>iterate_cut</td>
<td>60.0</td>
<td>359.0</td>
<td>0.16713</td>
</tr>
<tr>
<td>iterate_exception</td>
<td>4950.0</td>
<td>346.0</td>
<td>14.306</td>
</tr>
<tr>
<td>iterate_failure</td>
<td>400.0</td>
<td>127.0</td>
<td>3.1496</td>
</tr>
<tr>
<td>iterate_findall</td>
<td>740.0</td>
<td>No res.</td>
<td></td>
</tr>
<tr>
<td>iterate_if</td>
<td>140.0</td>
<td>6.0</td>
<td>23.333</td>
</tr>
</tbody>
</table>
The iterate_call benchmark, which constructs a predicate and calls it at
runtime, with a speedup of 662 times over SWI-Prolog is an example where the
JIT can show its strength. The Pyrolog interpreter and the JIT treat
dynamically defined predicates as static ones and can generate optimezed code
in both cases. Whereas SWI only compiles statically defined rules and has to
fall back to interpretation on dynamic ones.<br>
For simple benchmarks running on PyPy's Python intepreter we see some speedups
over CPython, but we still need to debug the backend bit more before we can
show numbers on more complex benchmarks. So, stay tuned.</div>
      </div>
      <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="pypy-wants-you-4543209863582915733.html" rel="prev" title="PyPy wants you!">Previous post</a>
            </li>
            <li class="next">
                <a href="../02/pypy-faster-than-c-on-carefully-crafted-5614784244310486765.html" rel="next" title="PyPy faster than C on a carefully crafted example">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
                <div class="comment-level comment-level-1">
      <div class="comment comment-3247073772687763599">
        <div class="comment-header">
          <a name="comment-3247073772687763599"></a>
            <span class="author">Anonymous</span> wrote on <span class="date">2011-01-30 10:01</span>:
        </div>
        <div class="comment-content">
          <p>Awesome stuff.  I have a panda board and another xm that's usually not doing much if you want to borrow some cycles :-)<br><br>When you support floats will you be aiming for hard float?  It's the way of the future, I hear...</p>
        </div>
      </div>
      <div class="comment comment-8869000827477806234">
        <div class="comment-header">
          <a name="comment-8869000827477806234"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2011-01-30 11:47</span>:
        </div>
        <div class="comment-content">
          <p>I am curious if you had any use for ThumbEE (or Jazelle RCT) to speed up?</p>
        </div>
      </div>
      <div class="comment comment-5715738330822619623">
        <div class="comment-header">
          <a name="comment-5715738330822619623"></a>
            <span class="author">David Schneider</span> wrote on <span class="date">2011-01-30 19:05</span>:
        </div>
        <div class="comment-content">
          <p>@mwhudson: thanks it would be great to be able to test on more hardware.<br><br>For the float support we still need to investigate a bit, but if possible I would like to target hard floats.<br><br>@dbrodie: currently we are targeting the arm state, so not at the moment.</p>
        </div>
      </div>
      <div class="comment comment-6382604539450333842">
        <div class="comment-header">
          <a name="comment-6382604539450333842"></a>
            <span class="author">Martijn Faassen</span> wrote on <span class="date">2011-01-31 14:11</span>:
        </div>
        <div class="comment-content">
          <p>One would imagine conserving memory would be an important factor on mobile devices. Even though mobile devices have a growing amount of memory available, it will still be less than desktops for the forseeable future. Memory pressure can create real slowdowns.<br><br>A JIT normally takes more memory, but on the other hand PyPy offers features to reduce usage of memory. Could you share some of your thinking on this?</p>
        </div>
      </div>
      <div class="comment comment-795390280737731275">
        <div class="comment-header">
          <a name="comment-795390280737731275"></a>
            <span class="author">Armin Rigo</span> wrote on <span class="date">2011-02-05 19:51</span>:
        </div>
        <div class="comment-content">
          <p>Martijn: you are describing the situation as well as we (at least I) know it so far: while PyPy has in many cases a lower non-JIT memory usage, the JIT adds some overhead.  But it seems to be within ~200MB on "pypy translate.py", which is kind of the extreme example in hugeness.  So already on today's high-end boards with 1GB of RAM, it should easily fit.  Moreover it can be tweaked, e.g. it's probably better on these systems to increase the threshold at which JITting starts (which also reduces the number of JITted code paths).  So I think that the possibility is real.</p>
        </div>
      </div>
      <div class="comment comment-1792554686051912332">
        <div class="comment-header">
          <a name="comment-1792554686051912332"></a>
            <span class="author">Dan</span> wrote on <span class="date">2011-04-30 16:40</span>:
        </div>
        <div class="comment-content">
          <p>Showing speedups over repetitive instructions (which caching &amp; JIT are really good at) is irrelevant.<br><br>What happens when people use real benchmarks, like constraint-based solvers and non-iterative stuff (maybe take a look at the other benchmarks) ...<br><br>Prolog is a declative language, not a sysadmin scripting language.<br><br>Also, the SWI implementation adds so many functionalities, it's like making a «Extract chars from an RDBMS vs Text files» benchmark.</p>
        </div>
      </div>
      <div class="comment comment-3984841426980649696">
        <div class="comment-header">
          <a name="comment-3984841426980649696"></a>
            <span class="author">Carl Friedrich Bolz-Tereick</span> wrote on <span class="date">2011-05-02 19:02</span>:
        </div>
        <div class="comment-content">
          <p>@Dan<br><br>Why are you so defensive? This benchmark is clearly not about how fast Pyrolog is, but how the ARM JIT backend performs, using trivial Prolog microbenchmarks, with SWI to give a number to compare against.<br><br>Pyrolog is a minimal Prolog implementation that is (at least so far) mostly an experiment to see how well PyPy's JIT technology can do on an non-imperative language. This paper contains more interesting benchmarks:<br><br>https://portal.acm.org/citation.cfm?id=1836102</p>
        </div>
      </div>
      <div class="comment comment-9145169645150685772">
        <div class="comment-header">
          <a name="comment-9145169645150685772"></a>
            <span class="author">jamu</span> wrote on <span class="date">2011-05-16 13:11</span>:
        </div>
        <div class="comment-content">
          <p>Hi,<br>Is there a way to cross compile on a host machine (but not with scratch box) where I have tool chain and file system for the target?<br><br>Any instructions for building with arm back-end?<br><br>Cheers</p>
        </div>
      </div>
      <div class="comment comment-5052740497856444342">
        <div class="comment-header">
          <a name="comment-5052740497856444342"></a>
            <span class="author">David Schneider</span> wrote on <span class="date">2011-06-08 20:41</span>:
        </div>
        <div class="comment-content">
          <p>@jamu: scratchbox 2 is currently the only option to cross-translate pypy for ARM. You can find some documentation about the cross translation at https://foss.heptapod.net/pypy/pypy/-/tree/branch/arm-backend-2/pypy/doc/arm.rst</p>
        </div>
      </div>
      <div class="comment comment-1731218078112566368">
        <div class="comment-header">
          <a name="comment-1731218078112566368"></a>
            <span class="author">vak</span> wrote on <span class="date">2011-09-30 10:12</span>:
        </div>
        <div class="comment-content">
          <p>Sounds very cool, are there any updates?</p>
        </div>
      </div>
         </div>

          </section>
</div>
    <div class="sidebar">
<div>
  <h2>
    The PyPy blogposts
  </h2>
  <div>
    Create a guest post via a PR to the <a href="https://github.com/pypy/pypy.org">source repo</a>
  </div>
</div>
    <div id="global-recent-posts">
    <h2>
      Recent Posts
    </h2>
    <ul class="post-list">
      <li>
        <a href="/posts/2020/12/mac-meets-arm64-940822335619099039.html" class="listtitle">Mac meets Arm64</a>
      </li>
      <li>
        <a href="/posts/2020/11/pypy-733-triple-release-python-37-36-3446596804408262749.html" class="listtitle">PyPy 7.3.3 triple release: python 3.7, 3.6, and 2.7</a>
      </li>
      <li>
        <a href="/posts/2020/09/pypy-732-triple-release-python-27-36-3980901335490872787.html" class="listtitle">PyPy 7.3.2 triple release: python 2.7, 3.6, and 3.7</a>
      </li>
      <li>
        <a href="/posts/2020/08/pypy-is-on-open-collective-5673322428814364737.html" class="listtitle">PyPy is on Open Collective</a>
      </li>
      <li>
        <a href="/posts/2020/08/a-new-chapter-for-pypy-8388322709667328389.html" class="listtitle">A new chapter for PyPy</a>
      </li>
      <li>
        <a href="/posts/2020/04/pypy-731-released-6266451647387657480.html" class="listtitle">PyPy 7.3.1 released</a>
      </li>
      <li>
        <a href="/posts/2020/03/leysin-2020-sprint-report-764567777353955897.html" class="listtitle">Leysin 2020 Sprint Report</a>
      </li>
      <li>
        <a href="/posts/2020/02/pypy-and-cffi-have-moved-to-heptapod-5791595152472747032.html" class="listtitle">PyPy and CFFI have moved to Heptapod</a>
      </li>
      <li>
        <a href="/posts/2020/01/leysin-winter-sprint-2020-feb-28-march-6349761524797409012.html" class="listtitle">Leysin Winter sprint 2020: Feb 29 - March 8th</a>
      </li>
      <li>
        <a href="/posts/2019/12/pypy-730-released-3614026620096963655.html" class="listtitle">PyPy 7.3.0 released</a>
      </li>
    </ul>
  </div>

          <div id="global-archive-list">
          <h2>
            Archives
          </h2>
          <ul class="archive-level archive-level-1">
            <li><a class="reference" href="/2007/">2007</a> (19)
            </li>
            <li><a class="reference" href="/2008/">2008</a> (62)
            </li>
            <li><a class="reference" href="/2009/">2009</a> (38)
            </li>
            <li><a class="reference" href="/2010/">2010</a> (44)
            </li>
            <li><a class="reference" href="/2011/">2011</a> (43)
            </li>
            <li><a class="reference" href="/2012/">2012</a> (44)
            </li>
            <li><a class="reference" href="/2013/">2013</a> (46)
            </li>
            <li><a class="reference" href="/2014/">2014</a> (22)
            </li>
            <li><a class="reference" href="/2015/">2015</a> (20)
            </li>
            <li><a class="reference" href="/2016/">2016</a> (20)
            </li>
            <li><a class="reference" href="/2017/">2017</a> (13)
            </li>
            <li><a class="reference" href="/2018/">2018</a> (12)
            </li>
            <li><a class="reference" href="/2019/">2019</a> (12)
            </li>
            <li><a class="reference" href="/2020/">2020</a> (9)
            </li>
          </ul>
        </div>


          <div id="global-tag-list">
          <h2>
            Tags
          </h2>
          <ul>
            <li><a class="reference" href="/categories/arm.html">arm</a> (1)</li>
            <li><a class="reference" href="/categories/cli.html">cli</a> (1)</li>
            <li><a class="reference" href="/categories/compiler.html">compiler</a> (1)</li>
            <li><a class="reference" href="/categories/cpyext.html">cpyext</a> (3)</li>
            <li><a class="reference" href="/categories/cpython.html">CPython</a> (3)</li>
            <li><a class="reference" href="/categories/ep2008.html">ep2008</a> (1)</li>
            <li><a class="reference" href="/categories/extension-modules.html">extension modules</a> (2)</li>
            <li><a class="reference" href="/categories/graalpython.html">GraalPython</a> (1)</li>
            <li><a class="reference" href="/categories/hpy.html">hpy</a> (1)</li>
            <li><a class="reference" href="/categories/heptapod.html">Heptapod</a> (1)</li>
            <li><a class="reference" href="/categories/jit.html">jit</a> (18)</li>
            <li><a class="reference" href="/categories/jython.html">jython</a> (1)</li>
            <li><a class="reference" href="/categories/kcachegrind.html">kcachegrind</a> (1)</li>
            <li><a class="reference" href="/categories/numpy.html">numpy</a> (24)</li>
            <li><a class="reference" href="/categories/parser.html">parser</a> (1)</li>
            <li><a class="reference" href="/categories/profiling.html">profiling</a> (1)</li>
            <li><a class="reference" href="/categories/pypy.html">pypy</a> (6)</li>
            <li><a class="reference" href="/categories/pypy3.html">pypy3</a> (16)</li>
            <li><a class="reference" href="/categories/pyqt4.html">PyQt4</a> (1)</li>
            <li><a class="reference" href="/categories/release.html">release</a> (47)</li>
            <li><a class="reference" href="/categories/releasecffi.html">releasecffi</a> (3)</li>
            <li><a class="reference" href="/categories/releasepypy.html">releasepypy</a> (1)</li>
            <li><a class="reference" href="/categories/releaserevdb.html">releaserevdb</a> (1)</li>
            <li><a class="reference" href="/categories/releasestm.html">releasestm</a> (1)</li>
            <li><a class="reference" href="/categories/revdb.html">revdb</a> (1)</li>
            <li><a class="reference" href="/categories/roadmap.html">roadmap</a> (1)</li>
            <li><a class="reference" href="/categories/rpyc.html">RPyC</a> (1)</li>
            <li><a class="reference" href="/categories/speed.html">speed</a> (3)</li>
            <li><a class="reference" href="/categories/sprint.html">sprint</a> (3)</li>
            <li><a class="reference" href="/categories/stm.html">stm</a> (14)</li>
            <li><a class="reference" href="/categories/sun.html">sun</a> (1)</li>
            <li><a class="reference" href="/categories/smalltalk.html">Smalltalk</a> (1)</li>
            <li><a class="reference" href="/categories/squeak.html">Squeak</a> (1)</li>
            <li><a class="reference" href="/categories/unicode.html">unicode</a> (1)</li>
            <li><a class="reference" href="/categories/valgrind.html">valgrind</a> (1)</li>
          </ul>
        </div>    </div>
</article></main><footer id="footer"><p>
</p>
<div class="myfooter">
  <div>
    <img src="../../../images/pypy-logo-nav-grey.png" alt="PyPy Logo">
</div>
  <div class="logotext">
     Contents © 2021 <a href="mailto:pypy-dev@pypy.org">The PyPy Team</a>
    Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a> 
  </div>
  <div style="margin-left: auto">
  <a href="rss.xml">RSS feed</a>
</div>

            
        

    </div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" crossorigin="anonymous"></script><script src="../../../assets/js/styles.js"></script></footer>
</div>
</body>
</html>
